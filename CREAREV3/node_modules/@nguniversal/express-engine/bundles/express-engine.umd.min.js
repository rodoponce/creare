!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("fs"),require("@angular/core"),require("@angular/compiler"),require("@angular/platform-server")):"function"==typeof define&&define.amd?define(["exports","fs","@angular/core","@angular/compiler","@angular/platform-server"],r):r((e.nguniversal=e.nguniversal||{},e.nguniversal.expressEngine=e.nguniversal.expressEngine||{}),e.fs,e.ng.core,e.ng.compiler,e.ng.platformServer)}(this,function(e,r,n,o,t){"use strict";var i=function(){function e(){}return e.prototype.get=function(e){return new Promise(function(n,o){r.readFile(e,function(e,r){if(e)return o(e);n(r.toString())})})},e}(),u=new n.InjectionToken("REQUEST"),a=new n.InjectionToken("RESPONSE"),s={},c=new Map;e.ngExpressEngine=function(e){var l=t.platformDynamicServer().injector.get(n.CompilerFactory).createCompiler([{providers:[{provide:o.ResourceLoader,useClass:i,deps:[]}]}]);return function(o,i,p){i.providers=i.providers||[];try{var f=i.bootstrap||e.bootstrap;if(!f)throw new Error("You must pass in a NgModule or NgModuleFactory to be bootstrapped");e.providers=e.providers||[];var d=e.providers.concat(i.providers,(v=i.req,g=i.res,m=[{provide:u,useValue:v}],g&&m.push({provide:a,useValue:g}),m),[{provide:t.INITIAL_CONFIG,useValue:{document:i.document||(S=o,s[S]=s[S]||r.readFileSync(S).toString()),url:i.url||i.req.originalUrl}}]);(y=f,E=l,new Promise(function(e,r){if(y instanceof n.NgModuleFactory)e(y);else{var o=c.get(y);o?e(o):E.compileModuleAsync(y).then(function(r){c.set(y,r),e(r)},function(e){r(e)})}})).then(function(e){return t.renderModuleFactory(e,{extraProviders:d})}).then(function(e){p(null,e)},function(e){p(e)})}catch(e){p(e)}var v,g,m,y,E,S}},e.RESPONSE=a,e.REQUEST=u,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=express-engine.umd.min.js.map
